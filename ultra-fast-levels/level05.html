<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Level 5 - Quick Math</title>
	<style>
		.button-style {
			position: fixed;
			transform: translate(-50%, -50%);
			font-size: clamp(32px, 6vw, 64px);
			padding: 3vh 8vw;
			border-radius: 20px;
			border: none;
			background: #0330f8;
			color: white;
			cursor: pointer;
			font-weight: bold;
		}

		.solution-button {
			display: none;
			position: relative;
			/* Slightly reduced to visually match the example (~8%) */
			font-size: clamp(36px, 7.2vw, 108px);
			padding: 1.1vh 2.2vw;
			width: 100%;
			min-width: 150px;
			max-width: 440px;
			border-radius: 18px;
			border: 1px solid rgba(3, 48, 248, 0.18);
			/* More pronounced modern blue tint */
			background: linear-gradient(180deg, #fbfdff 0%, #eaf4ff 100%);
			color: #041833;
			font-weight: 700;
			cursor: pointer;
			text-align: center;
			box-shadow: 0 14px 26px rgba(3, 48, 248, 0.08), inset 4px 0 12px rgba(3,48,248,0.03), inset 0 -2px 6px rgba(0,0,0,0.02);
			/* removed transform/scale animations to keep UI stable */
		}

		.solution-container {
			display: grid;
			grid-template-columns: repeat(2, minmax(160px, 42vw));
			gap: 2.4vh 3vw;
			justify-content: center;
			position: fixed;
			left: 50%;
			top: 48%;
			transform: translateX(-50%);
			width: 88vw;
			max-width: 920px;
			padding: 0 2vw;
			box-sizing: border-box;
		}

		.solution-button:hover,
		.solution-button:focus {
			/* keep a stronger shadow and slightly brighter background, but no movement */
			background: linear-gradient(180deg, #ffffff 0%, #dff0ff 100%);
			box-shadow: 0 20px 38px rgba(3, 48, 248, 0.14), 0 0 0 6px rgba(3,48,248,0.06);
			outline: none;
		}

		.solution-button:active {
			/* no transform on active; keep immediate feedback visual via background only */
			background: linear-gradient(180deg, #f8fbff 0%, #dbeeff 100%);
		}

		@media (max-width: 600px) {
			.solution-container {
			grid-template-columns: repeat(2, minmax(140px, 44vw));
			gap: 2vh 2vw;
			top: 47%;
		}
		.solution-button {
			/* Keep 2x2 grid on mobile, adjust sizing */
			font-size: clamp(32px, 9vw, 72px);
			padding: 2vh 3vw;
			min-width: 140px;	}
		}

		.score-style {
			position: fixed;
			top: 3vh;
			left: 4vw;
			font-size: clamp(24px, 4.5vw, 42px);
			color: rgb(3, 48, 248);
			margin: 0;
		}

		.result-style {
			display: none;
			position: fixed;
			transform: translate(-50%, -50%);
			font-size: clamp(40px, 8vw, 120px);
			padding: 1vh 2vw;
			border-radius: 20px;
			border: none;
			color: rgb(0, 0, 0);
			cursor: pointer;
			white-space: nowrap;
		}

		.back-button {
			position: fixed;
			top: 3vh;
			right: 4vw;
			font-size: clamp(20px, 3vw, 32px);
			padding: 1vh 2vw;
			border-radius: 15px;
			border: none;
			background: #0330f8;
			color: white;
			cursor: pointer;
			font-weight: bold;
		}

		.timer-style {
			position: fixed;
			top: 8vh;
			left: 49%;
			transform: translateX(-50%);
			font-size: clamp(24px, 4vw, 42px);
			color: rgb(88, 85, 85);
			margin: 0;
			font-weight: bold;
			display: none;
		}

		.description-title-style {
			position: fixed;
			top: 37%;
			left: 50%;
			transform: translate(-50%, -50%);
			font-size: clamp(18px, 3.5vw, 28px);
			color: white;
			margin: 0;
			text-align: center;
			font-weight: bold;
			padding: 1.5vh 3vw;
			border: 2px solid #8b5cf6;
			border-radius: 10px;
			background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
			box-shadow: 0 0 20px rgba(131, 92, 246, 0.6), inset 0 0 20px rgba(255, 255, 255, 0.1);
			animation: speedPulse 1.5s ease-in-out infinite;
		}

		.description-style {
			position: fixed;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			font-size: clamp(20px, 3.5vw, 32px);
			color: rgb(50, 50, 50);
			margin: 0;
			text-align: center;
			font-weight: 500;
		}

		.victory-screen {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 255, 0, 0.9);
			z-index: 1000;
		}

		.victory-message {
			position: fixed;
			top: 30%;
			left: 50%;
			transform: translate(-50%, -50%);
			font-size: clamp(48px, 8vw, 80px);
			color: white;
			font-weight: bold;
			text-align: center;
			text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
		}

		.next-level-button {
			position: fixed;
			top: 60%;
			left: 50%;
			transform: translate(-50%, -50%);
			font-size: clamp(32px, 6vw, 64px);
			padding: 3vh 8vw;
			border-radius: 20px;
			border: none;
			background: white;
			color: #0330f8;
			cursor: pointer;
			font-weight: bold;
			box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
		}

		.next-level-button:hover {
			transform: translate(-50%, -50%) scale(1.05);
		}

		@keyframes speedPulse {
			0%, 100% {
				box-shadow: 0 0 20px rgba(131, 92, 246, 0.6), inset 0 0 20px rgba(255, 255, 255, 0.1);
				transform: translate(-50%, -50%) scale(1);
			}
			50% {
				box-shadow: 0 0 40px rgba(131, 92, 246, 1), inset 0 0 20px rgba(255, 255, 255, 0.2);
				transform: translate(-50%, -50%) scale(1.02);
			}
		}

		.start-button {
			background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%) !important;
			border: 2px solid #8b5cf6 !important;
			box-shadow: 0 8px 16px rgba(45, 9, 153, 0.4), 0 0 40px rgba(147, 129, 199, 0.8), 0 0 80px rgba(131, 92, 246, 0.56) !important;
		}

		.start-button:hover {
			box-shadow: 0 8px 16px rgba(131, 92, 246, 0.60), 0 0 48px rgba(131, 92, 246, 0.8), 0 0 96px rgba(131, 92, 246, 0.64) !important;
		}

		@keyframes neonFlicker {
			0%   { opacity: 0.08; filter: saturate(0.8) brightness(0.7); }
			8%   { opacity: 0.9;  filter: saturate(1.4) brightness(1.15); }
			18%  { opacity: 0.2;  filter: saturate(0.9) brightness(0.8); }
			28%  { opacity: 1;    filter: saturate(1.7) brightness(1.3); }
			40%  { opacity: 0.15; filter: saturate(0.85) brightness(0.75); }
			55%  { opacity: 0.95; filter: saturate(1.9) brightness(1.35); }
			70%  { opacity: 0.3;  filter: saturate(1.1) brightness(0.9); }
			100% { opacity: 1;    filter: saturate(1.8) brightness(1.3); }
		}

		#neon-border {
			position: fixed;
			inset: 0;
			pointer-events: none;
			z-index: 2147483647;
			--bw: clamp(8px, 1.5vmin, 20px);
			--c: #ff1a1a;
			box-shadow:
				inset 0 0 35px 8px rgba(255, 0, 0, 0.75),
				inset 0 0 60px 15px rgba(255, 0, 0, 0.4),
				0 0 30px rgba(255, 0, 0, 0.6),
				0 0 70px rgba(255, 0, 0, 0.35),
				0 0 120px rgba(255, 0, 0, 0.15);
			animation: neonFlicker 1.4s infinite steps(2, end);
			will-change: opacity, filter;
			display: none;
		}

		@media (prefers-reduced-motion: reduce) {
			#neon-border { animation: none; opacity: 1; }
		}

		body.neon-blink {
			--neon-speed: 1.4s;
		}

		body.neon-blink #neon-border {
			display: block;
			animation: neonFlicker 1.4s infinite steps(2, end);
		}

		body.neon-blink-fast #neon-border {
			display: block;
			animation: neonFlicker 0.6s infinite steps(2, end);
			box-shadow:
				inset 0 0 50px 12px rgba(255, 0, 0, 0.85),
				inset 0 0 90px 25px rgba(255, 0, 0, 0.55),
				0 0 40px rgba(255, 0, 0, 0.75),
				0 0 100px rgba(255, 0, 0, 0.5),
				0 0 180px rgba(255, 0, 0, 0.25);
		}
	</style>
	<script src="./lock-levels.js"></script>
</head>
<body>
	<!-- Neon border overlay -->
	<div id="neon-border" aria-hidden="true"></div>

	<h1 style="
		text-align: center;
		font-size: clamp(32px, 5vw, 60px);
		margin: 2vh 0;
		">
		Level 5
	</h1>

	<button onclick="window.location.href='../levels-ultra-fast.html';" class="back-button">
		‚Üê Back
	</button>

	<h1 class="score-style">
		Score
	</h1>

	<h1 class="score-style" style="display: none;" id="Score">
	</h1>

	<h1 class="score-style" style="left: auto; right: 4vw; top: 8vh;" id="‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è">
	</h1>

	<h1 class="timer-style" id="timer">
		‚è±Ô∏è 30
	</h1>

	<p class="description-title-style" id="levelTitle">
		‚ö°Nieje ƒças na rozm√Ω≈°ƒæanie!<br> Neboj sa d√°m ti ƒæah≈°ie pr√≠klady‚ö°<br>(Boss LevelüíÄüëæ)
	</p>


	<p class="description-style" id="levelDescription">
		Score 20 points within 25 seconds
	</p>

	<button onclick="game()" class="button-style start-button" style="top: 65%; left: 50%;" id="startButton">
		Start
	</button>

	<h1 class="result-style" style="top: 25%; left: 50%;" id="result">‚Äî
	</h1>

	<div class="solution-container" id="solutions" aria-hidden="false">
		<button onclick="is_solution(this)" class="solution-button" id="solution1" aria-label="Option 1">‚Äî</button>
		<button onclick="is_solution(this)" class="solution-button" id="solution2" aria-label="Option 2">‚Äî</button>
		<button onclick="is_solution(this)" class="solution-button" id="solution3" aria-label="Option 3">‚Äî</button>
		<button onclick="is_solution(this)" class="solution-button" id="solution4" aria-label="Option 4">‚Äî</button>
	</div>

	<div class="victory-screen" id="victoryScreen">
		<div class="victory-message">
			üéâ LEVEL COMPLETE! üéâ
		</div>
		<button onclick="window.location.href='level04.html';" class="next-level-button">
			Next Level ‚Üí
		</button>
	</div>

	<!-- Spoloƒçn√Ω JavaScript s√∫bor pre v≈°etky levely -->
	<script src="../assets/common.js"></script>

	<script>
		let score = 0;
		let heart = 3;
		let correctAnswer = 0;
		let timeLeft = 25;
		let timerInterval = null;

		function updateHearts() {
			const heartsElement = document.getElementById("‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è");
			heartsElement.textContent = "‚ù§Ô∏è".repeat(heart);
		}

		function updateTimer() {
			const timerElement = document.getElementById("timer");
			timerElement.textContent = "‚è±Ô∏è " + timeLeft;
			
			// Zmena anim√°cie - zr√Ωchlenie blikania na posledn√Ωch 10 sek√∫nd
			if (timeLeft <= 10 && timeLeft > 0) {
				// Zr√Ωchlen√© blikanie - zme≈à len ak je potrebn√©
				if (!document.body.classList.contains('neon-blink-fast')) {
					document.body.classList.remove('neon-blink');
					document.body.classList.add('neon-blink-fast');
				}
				clock_tick_urgent(); // Intenz√≠vnej≈°√≠ zvuk pre posledn√Ωch 10 sek√∫nd
			} else if (timeLeft > 0) {
				// Norm√°lne pomal√© blikanie
				if (document.body.classList.contains('neon-blink-fast')) {
					document.body.classList.remove('neon-blink-fast');
					document.body.classList.add('neon-blink');
				}
				clock_tick(); // Norm√°lny tick
			}
			
			if (timeLeft <= 0) {
				clearInterval(timerInterval);
				document.body.classList.remove('neon-blink', 'neon-blink-fast');
				alert("TIME'S UP! Final Score: " + score);
				resetGame();
			}
		}

		function startTimer() {
			timeLeft = 25;
			document.getElementById("timer").style.display = "block";
			document.body.classList.add('neon-blink');  // Aktivuj blikanie
			updateTimer();
			
			if (timerInterval) {
				clearInterval(timerInterval);
			}
			
			timerInterval = setInterval(() => {
				timeLeft--;
				updateTimer();
			}, 1000);
		}



		function generate_number(min, max) {
			return Math.floor(Math.random() * (max - min + 1)) + min;
		}


		function generate_number2() {
			return Math.floor(Math.random() * 4);
		}


		function startGame() {
			// ensure no solution button remains focused from previous question
			document.querySelectorAll('.solution-button').forEach(b => b.blur && b.blur());
			updateHearts();
			const a = generate_number(1, 6);
			const b = generate_number(1, 6);
			const where_is_correct_anwser = generate_number2();
			

			const result = document.getElementById("result");
			const solution1 = document.getElementById("solution1");
			const solution2 = document.getElementById("solution2");
			const solution3 = document.getElementById("solution3");
			const solution4 = document.getElementById("solution4");
			const Score = document.getElementById("Score");

			Score.textContent = "Score: " + score;
			Score.style.display = "block";

			correctAnswer = a * b;

			result.textContent = a + " x " + b + " = ";
			
			
			result.style.display = "block";

			if (where_is_correct_anwser == 0) {
				solution1.textContent = correctAnswer;
				solution2.textContent = correctAnswer + 2;
				solution3.textContent = correctAnswer - 2;
				solution4.textContent = correctAnswer - 1;
			}
			if (where_is_correct_anwser == 1) {
				solution2.textContent = correctAnswer;
				solution1.textContent = correctAnswer + 2;
				solution4.textContent = correctAnswer - 2;
				solution3.textContent = correctAnswer - 1;
			}
			if (where_is_correct_anwser == 2) {
				solution3.textContent = correctAnswer;
				solution4.textContent = correctAnswer + 2;
				solution1.textContent = correctAnswer - 2;
				solution2.textContent = correctAnswer - 1;
			}
			if (where_is_correct_anwser == 3) {
				solution4.textContent = correctAnswer;
				solution1.textContent = correctAnswer + 2;
				solution3.textContent = correctAnswer - 2;
				solution2.textContent = correctAnswer - 1;
			}

			solution1.style.display = "block";
			solution2.style.display = "block";
			solution3.style.display = "block";
			solution4.style.display = "block";
		}

		function is_solution(el) {
			// remove focus from the button so it doesn't remain highlighted for next question
			el.blur && el.blur();
			const value = Number(el.textContent);

			if (value === correctAnswer) {
				score++;
				play_correct_answer_sound(); // Prehraj zvuk spr√°vnej odpovede
				
				// Check if player won the level
				if (score >= 20) {
					levelComplete();
					return;
				}
				
				document.body.style.backgroundColor = "rgb(0, 255, 0)";
				setTimeout(() => {
					document.body.style.backgroundColor = "white";
					startGame();
				}, 100);
			} else { 
				heart--;
				play_wrong_answer_sound(); // Prehraj zvuk nespr√°vnej odpovede
				updateHearts();
				document.body.style.backgroundColor = "rgb(255, 0, 0)";
				
				if (heart!=0){
					setTimeout(() => {
						document.body.style.backgroundColor = "white";
						startGame();
					}, 1000);
				}
				else{
					setTimeout(() => {
						document.body.style.backgroundColor = "white";
						alert("GAME OVER!!!");
						resetGame();
					}, 1000);
				}
			}
		}

		function levelComplete() {
			// Save completion status
			localStorage.setItem('level05_ultrafast_completed', 'true');
			
			// Prehraj achievement zvuky
			play_level_complete_sound();
			
			// Stop timer a blikanie
			if (timerInterval) {
				clearInterval(timerInterval);
				timerInterval = null;
			}
			document.body.classList.remove('neon-blink', 'neon-blink-fast');
			
			// Hide game elements
			document.getElementById("result").style.display = "none";
			document.getElementById("solution1").style.display = "none";
			document.getElementById("solution2").style.display = "none";
			document.getElementById("solution3").style.display = "none";
			document.getElementById("solution4").style.display = "none";
			document.getElementById("Score").style.display = "none";
			document.getElementById("timer").style.display = "none";
			document.getElementById("‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è").style.display = "none";
			
			// Show victory screen
			document.body.style.backgroundColor = "rgb(0, 255, 0)";
			setTimeout(() => {
				document.getElementById("victoryScreen").style.display = "block";
			}, 500);
		}

		function resetGame() {
			if (timerInterval) {
				clearInterval(timerInterval);
				timerInterval = null;
			}
			document.body.classList.remove('neon-blink', 'neon-blink-fast');
			
			document.getElementById("result").style.display = "none";
			document.getElementById("solution1").style.display = "none";
			document.getElementById("solution2").style.display = "none";
			document.getElementById("solution3").style.display = "none";
			document.getElementById("solution4").style.display = "none";
			document.getElementById("Score").style.display = "none";
			document.getElementById("timer").style.display = "none";
			document.getElementById("levelTitle").style.display = "block";
			document.getElementById("levelDescription").style.display = "block";
			document.getElementById("startButton").style.display = "block";
			document.body.style.backgroundColor = "white";
			score = 0;
			heart = 3;
			timeLeft = 25;
		}

		function game() {
			score = 0;
			heart = 3;
			document.getElementById("startButton").style.display = "none";
			document.getElementById("levelTitle").style.display = "none";
			document.getElementById("levelDescription").style.display = "none";
			startTimer();
			startGame();
		}
	</script>
</body>
</html>